<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>MySQL性能管理及架构设计(一) | Bameirilyo&#39;s Blog | 纵有疾风起，人生不言弃</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="数据库">
    <meta name="description" content="一、什么影响了数据库查询速度1.1 影响数据库查询速度的四个因素​    sql查询速度、服务器硬件、网卡流量、磁盘IO 1.2 风险分析 QPS：Queries Per Second意思是“每秒查询率”，是一台服务器每秒能够相应的查询次数，是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准。   TPS：是TransactionsPerSecond的缩写，也就是事务数/秒。它是软件测试">
<meta name="keywords" content="数据库">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL性能管理及架构设计(一)">
<meta property="og:url" content="https://bameirilyo.github.io/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/index.html">
<meta property="og:site_name" content="Bameirilyo&#39;s Blog">
<meta property="og:description" content="一、什么影响了数据库查询速度1.1 影响数据库查询速度的四个因素​    sql查询速度、服务器硬件、网卡流量、磁盘IO 1.2 风险分析 QPS：Queries Per Second意思是“每秒查询率”，是一台服务器每秒能够相应的查询次数，是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准。   TPS：是TransactionsPerSecond的缩写，也就是事务数/秒。它是软件测试">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://bameirilyo.github.io/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/MySQL性能管理及架构设计/MySQL体系结构.png">
<meta property="og:image" content="https://bameirilyo.github.io/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/MySQL性能管理及架构设计/InnoDB.png">
<meta property="og:updated_time" content="2018-07-16T07:02:03.098Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MySQL性能管理及架构设计(一)">
<meta name="twitter:description" content="一、什么影响了数据库查询速度1.1 影响数据库查询速度的四个因素​    sql查询速度、服务器硬件、网卡流量、磁盘IO 1.2 风险分析 QPS：Queries Per Second意思是“每秒查询率”，是一台服务器每秒能够相应的查询次数，是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准。   TPS：是TransactionsPerSecond的缩写，也就是事务数/秒。它是软件测试">
<meta name="twitter:image" content="https://bameirilyo.github.io/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/MySQL性能管理及架构设计/MySQL体系结构.png">
    
        <link rel="alternate" type="application/atom+xml" title="Bameirilyo&#39;s Blog" href="/BameirilyoBlog/atom.xml">
    
    <link rel="shortcut icon" href="/BameirilyoBlog/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/BameirilyoBlog/img/brand.jpg)">
      <div class="brand">
        <a href="/BameirilyoBlog/" class="avatar waves-effect waves-circle waves-light">
          <img src="/BameirilyoBlog/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">豆腐小铭</h5>
          <a href="mailto:1172277547@qq.com" title="1172277547@qq.com" class="mail">1172277547@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/BameirilyoBlog/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/BameirilyoBlog/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                目录
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/BameirilyoBlog/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/BameirilyoBlog/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/Bameirilyo" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://weibo.com/3287259165/profile?topnav=1&wvr=6" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">MySQL性能管理及架构设计(一)</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">MySQL性能管理及架构设计(一)</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-07-15T12:35:20.000Z" itemprop="datePublished" class="page-time">
  2018年07月15日
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/BameirilyoBlog/categories/数据库/">数据库</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#一、什么影响了数据库查询速度"><span class="post-toc-text">一、什么影响了数据库查询速度</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-1-影响数据库查询速度的四个因素"><span class="post-toc-text">1.1 影响数据库查询速度的四个因素</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-2-风险分析"><span class="post-toc-text">1.2 风险分析</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-3-网卡流量：如何避免无法连接数据库的情况"><span class="post-toc-text">1.3 网卡流量：如何避免无法连接数据库的情况</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-4-大表带来的问题（重要）"><span class="post-toc-text">1.4 大表带来的问题（重要）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-4-1-大表的特点"><span class="post-toc-text">1.4.1 大表的特点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-4-2-大表的危害"><span class="post-toc-text">1.4.2 大表的危害</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-4-3-如何处理数据库上的大表"><span class="post-toc-text">1.4.3 如何处理数据库上的大表</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-5-大事务带来的问题（重要）"><span class="post-toc-text">1.5 大事务带来的问题（重要）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-5-1-什么是事务"><span class="post-toc-text">1.5.1 什么是事务</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-5-2事务的ACID属性"><span class="post-toc-text">1.5.2事务的ACID属性</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-5-3-大事务"><span class="post-toc-text">1.5.3 大事务</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#二、什么影响了MySQL性能"><span class="post-toc-text">二、什么影响了MySQL性能</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-1-影响性能的几个方面"><span class="post-toc-text">2.1 影响性能的几个方面</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-2-MySQL体系结构"><span class="post-toc-text">2.2 MySQL体系结构</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-3-InnoDB存储引擎"><span class="post-toc-text">2.3 InnoDB存储引擎</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-3-1-InnoDB使用表空间进行数据存储。"><span class="post-toc-text">2.3.1 InnoDB使用表空间进行数据存储。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-3-2-MySQL5-5默认-系统表空间与-MySQL5-6及以后默认-独立表空间"><span class="post-toc-text">2.3.2 (MySQL5.5默认)系统表空间与(MySQL5.6及以后默认)独立表空间</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-3-3-系统表空间的表转移到独立表空间中的方法"><span class="post-toc-text">2.3.3 系统表空间的表转移到独立表空间中的方法</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-4-InnoDB存储引擎的特性"><span class="post-toc-text">2.4 InnoDB存储引擎的特性</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-4-1-特性一：事务性存储引擎及两个特殊日志类型：Redo-Log-和-Undo-Log"><span class="post-toc-text">2.4.1 特性一：事务性存储引擎及两个特殊日志类型：Redo Log 和 Undo Log</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-4-2-特性二：支持行级锁"><span class="post-toc-text">2.4.2 特性二：支持行级锁</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-4-3-特性三：Innodb状态检查"><span class="post-toc-text">2.4.3 特性三：Innodb状态检查</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-4-4-适用场景"><span class="post-toc-text">2.4.4 适用场景</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-5-什么是锁"><span class="post-toc-text">2.5 什么是锁</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-5-1-锁"><span class="post-toc-text">2.5.1 锁</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-5-2-锁类型"><span class="post-toc-text">2.5.2 锁类型</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-5-3-锁的粒度"><span class="post-toc-text">2.5.3 锁的粒度</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-5-4-阻塞和死锁"><span class="post-toc-text">2.5.4 阻塞和死锁</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-6-CSV存储引擎"><span class="post-toc-text">2.6 CSV存储引擎</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-6-1-CSV存储引擎文件系统存储特点："><span class="post-toc-text">2.6.1 CSV存储引擎文件系统存储特点：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-6-2-CSV存储引擎特点："><span class="post-toc-text">2.6.2 CSV存储引擎特点：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-6-3-适合场景"><span class="post-toc-text">2.6.3 适合场景</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-7-Archive存储引擎"><span class="post-toc-text">2.7 Archive存储引擎</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-7-1-Archive存储引擎文件系统存储特点"><span class="post-toc-text">2.7.1 Archive存储引擎文件系统存储特点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-7-2-Archive存储引擎特点："><span class="post-toc-text">2.7.2 Archive存储引擎特点：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-7-3-适合场景"><span class="post-toc-text">2.7.3 适合场景</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-8-Memory存储引擎"><span class="post-toc-text">2.8 Memory存储引擎</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-8-1-Memory存储引擎文件系统存储特点"><span class="post-toc-text">2.8.1 Memory存储引擎文件系统存储特点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-8-2-Memory存储引擎特点："><span class="post-toc-text">2.8.2 Memory存储引擎特点：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-8-3-Memory存储引擎表-VS临时表"><span class="post-toc-text">2.8.3 Memory存储引擎表 VS临时表</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-8-4-适合场景"><span class="post-toc-text">2.8.4 适合场景</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-9-Federated存储引擎"><span class="post-toc-text">2.9 Federated存储引擎</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-9-1-Federated存储引擎特点"><span class="post-toc-text">2.9.1 Federated存储引擎特点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-9-2-如何使用Federated存储引擎"><span class="post-toc-text">2.9.2 如何使用Federated存储引擎</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-9-3适用场景"><span class="post-toc-text">2.9.3适用场景</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-10-如何选择正确的存储引擎"><span class="post-toc-text">2.10 如何选择正确的存储引擎</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-11-配置参数"><span class="post-toc-text">2.11 配置参数</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-11-1-MySQL获取配置信息路径"><span class="post-toc-text">2.11.1 MySQL获取配置信息路径</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-11-2-MySQL配置参数的作用域"><span class="post-toc-text">2.11.2 MySQL配置参数的作用域</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-11-3-内存配置相关参数"><span class="post-toc-text">2.11.3 内存配置相关参数</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-12-性能优化顺序"><span class="post-toc-text">2.12 性能优化顺序</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-MySQL性能管理及架构设计(一)"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">MySQL性能管理及架构设计(一)</h1>
        <div class="post-meta">
            <time class="post-time" title="2018年07月15日 20:35:20" datetime="2018-07-15T12:35:20.000Z"  itemprop="datePublished">2018年07月15日</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/BameirilyoBlog/categories/数据库/">数据库</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="一、什么影响了数据库查询速度"><a href="#一、什么影响了数据库查询速度" class="headerlink" title="一、什么影响了数据库查询速度"></a>一、什么影响了数据库查询速度</h1><h2 id="1-1-影响数据库查询速度的四个因素"><a href="#1-1-影响数据库查询速度的四个因素" class="headerlink" title="1.1 影响数据库查询速度的四个因素"></a>1.1 影响数据库查询速度的四个因素</h2><p>​    sql查询速度、服务器硬件、网卡流量、磁盘IO</p>
<h2 id="1-2-风险分析"><a href="#1-2-风险分析" class="headerlink" title="1.2 风险分析"></a>1.2 风险分析</h2><blockquote>
<p>QPS：<code>Queries Per Second</code>意思是“每秒查询率”，是一台服务器每秒能够相应的查询次数，是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准。</p>
</blockquote>
<blockquote>
<p>TPS：是<code>TransactionsPerSecond</code>的缩写，也就是事务数/秒。它是软件测试结果的测量单位。客户机在发送请求时开始计时，收到服务器响应后结束计时，以此来计算使用的时间和完成的事务个数。</p>
</blockquote>
<p>​    Tips：最好不要在主库上数据库备份，大型活动前取消这样的计划。</p>
<ol>
<li>效率低下的<code>sql</code>：超高的<code>QPS</code>与<code>TPS</code>。</li>
<li>大量的并发：数据连接数被占满（<code>max_connection</code>默认<code>100</code>，一般把连接数设置得大一些）。<br>并发量:同一时刻数据库服务器处理的请求数量</li>
<li>超高的<code>CPU</code>使用率：<code>CPU</code>资源耗尽出现宕机。</li>
<li>磁盘<code>IO</code>：磁盘<code>IO</code>性能突然下降、大量消耗磁盘性能的计划任务。解决：更快磁盘设备、调整计划任务、做好磁盘维护。</li>
</ol>
<h2 id="1-3-网卡流量：如何避免无法连接数据库的情况"><a href="#1-3-网卡流量：如何避免无法连接数据库的情况" class="headerlink" title="1.3 网卡流量：如何避免无法连接数据库的情况"></a>1.3 网卡流量：如何避免无法连接数据库的情况</h2><ol>
<li>减少从服务器的数量（从服务器会从主服务器复制日志）</li>
<li>进行分级缓存（避免前端大量缓存失效）</li>
<li>避免使用<code>select *</code> 进行查询</li>
<li>分离业务网络和服务器网络</li>
</ol>
<h2 id="1-4-大表带来的问题（重要）"><a href="#1-4-大表带来的问题（重要）" class="headerlink" title="1.4 大表带来的问题（重要）"></a>1.4 大表带来的问题（<code>重要</code>）</h2><h3 id="1-4-1-大表的特点"><a href="#1-4-1-大表的特点" class="headerlink" title="1.4.1 大表的特点"></a>1.4.1 大表的特点</h3><ol>
<li>记录行数巨大，单表超千万</li>
<li>表数据文件巨大，超过10个G</li>
</ol>
<h3 id="1-4-2-大表的危害"><a href="#1-4-2-大表的危害" class="headerlink" title="1.4.2 大表的危害"></a>1.4.2 大表的危害</h3><p>1.慢查询：很难在短时间内过滤出需要的数据<br>    查询字区分度低 -&gt; 要在大数据量的表中筛选出来其中一部分数据会产生大量的磁盘io -&gt; 降低磁盘效率</p>
<p>2.对DDL操作影响：</p>
<p>​    建立索引需要很长时间：</p>
<ul>
<li><code>MySQL -v&lt;5.5</code> 建立索引会锁表</li>
<li><code>MySQL -v&gt;=5.5</code> 建立索引会造成主从延迟（<code>mysql</code>建立索引，先在组上执行，再在库上执行）</li>
</ul>
<p>​    修改表结构需要长时间的锁表：会造成长时间的主从延迟(‘480秒延迟’)</p>
<h3 id="1-4-3-如何处理数据库上的大表"><a href="#1-4-3-如何处理数据库上的大表" class="headerlink" title="1.4.3 如何处理数据库上的大表"></a>1.4.3 如何处理数据库上的大表</h3><blockquote>
<p>1.分库分表把一张大表分成多个小表</p>
</blockquote>
<p>​    难点：分表主键的选择、分表后跨分区数据的查询和统计</p>
<p>2.大表历史数据归档（减少对前后端业务的影响）</p>
<p>难点：归档时间点的选择、如何进行归档操作</p>
<h2 id="1-5-大事务带来的问题（重要）"><a href="#1-5-大事务带来的问题（重要）" class="headerlink" title="1.5 大事务带来的问题（重要）"></a>1.5 大事务带来的问题（<code>重要</code>）</h2><h3 id="1-5-1-什么是事务"><a href="#1-5-1-什么是事务" class="headerlink" title="1.5.1 什么是事务"></a>1.5.1 什么是事务</h3><ol>
<li>事务时数据库区别于其它一切文件系统的重要特性之一</li>
<li>事务时一组具有原子性的SQL语句，或是一个独立的工作单元</li>
</ol>
<h3 id="1-5-2事务的ACID属性"><a href="#1-5-2事务的ACID属性" class="headerlink" title="1.5.2事务的ACID属性"></a>1.5.2事务的<code>ACID</code>属性</h3><blockquote>
<p>1、原子性（<code>atomicity</code>)：全部成功，全部回滚失败。银行存取款。</p>
</blockquote>
<blockquote>
<p>2、一致性（consistent)：银行转账的总金额不变。</p>
</blockquote>
<blockquote>
<p>3、隔离性（isolation)：</p>
</blockquote>
<p>​    隔离性等级（隔离性由低到高，并发行由高到低）：</p>
<ul>
<li>未提交读(<code>READ UNCOMMITED</code>) 脏读,两个事务之间互相可见；</li>
<li>已提交读(<code>READ COMMITED</code>)符合隔离性的基本概念,一个事务进行时，其它已提交的事物对于该事务是可见的，即可以获取其它事务提交的数据。</li>
<li>可重复读(<code>REPEATABLE READ</code>) <code>InnoDB的默认隔离等级</code>。事务进行时，其它所有事务对其不可见，即多次执行读，得到的结果是一样的！</li>
<li>可串行化（<code>SERIALIZABLE</code>） 在读取的每一行数据上都加锁，会造成大量的锁超时和锁征用，严格数据一致性且没有并发是可使用。</li>
</ul>
<p>​    查看系统的事务隔离级别：<code>show variables like &#39;%iso%&#39;</code>;<br>    开启一个新事务：<code>begin</code>;<br>    提交一个事务：<code>commit</code>;<br>    修改事物的隔离级别：<code>set session tx_isolation=&#39;read-committed&#39;</code>;</p>
<blockquote>
<p>4、持久性(<code>DURABILITY</code>)：从数据库的角度的持久性，磁盘损坏就不行了</p>
</blockquote>
<h2 id="1-5-3-大事务"><a href="#1-5-3-大事务" class="headerlink" title="1.5.3 大事务"></a>1.5.3 大事务</h2><blockquote>
<p>运行时间长，操作数据比较多的事务；</p>
</blockquote>
<p>​    风险：锁定数据太多，回滚时间长，执行时间长。</p>
<ol>
<li><p>锁定太多数据，造成大量阻塞和锁超时；</p>
</li>
<li><p>回滚时所需时间比较长，且数据仍然会处于锁定；</p>
</li>
<li><p>如果执行时间长，将造成主从延迟，因为只有当主服务器全部执行完写入日志时，从服务器才会开始进行同步，造成延迟。</p>
<p>如何处理大事务：</p>
</li>
<li><p>避免一次处理太多数据，可以分批次处理；</p>
</li>
<li><p>移出不必要的<code>SELECT</code>操作，保证事务中只有必要的写操作。</p>
</li>
</ol>
<h1 id="二、什么影响了MySQL性能"><a href="#二、什么影响了MySQL性能" class="headerlink" title="二、什么影响了MySQL性能"></a>二、什么影响了MySQL性能</h1><h2 id="2-1-影响性能的几个方面"><a href="#2-1-影响性能的几个方面" class="headerlink" title="2.1 影响性能的几个方面"></a>2.1 影响性能的几个方面</h2><ol>
<li><p>服务器硬件：</p>
<ul>
<li>CPU：64位的CPU一定要工作在64位的系统下；对于并发比较高的场景CPU的数量比频率重要；对于CPU密集性场景和复杂SQL则频率越高越好。</li>
<li>内存：选择主板所能使用的最高频率的内存；内存的大小对性能很重要，所以尽可能的大</li>
<li>I/O子系统：PCIe -&gt;SSD -&gt;Raid10 -&gt; 磁盘 -&gt;SAN</li>
</ul>
<p>PS：1.MySQL不支持多CPU对同一SQL并发处理</p>
<p>​    2.WEB应用中CPU数量比频率更重要</p>
<p>​    3.内存越多越好，但是对性能影响有限，并不能无限的增加性能</p>
</li>
<li><p>服务器系统（系统参数优化）。</p>
</li>
<li><p>数据库存储引擎。<br><code>MyISAM</code>：不支持事务，表级锁。<br><code>InnoDB</code>: 事务级存储引擎，完美支持支持行级锁，事务<code>ACID</code>特性。</p>
</li>
<li><p>数据库参数配置。</p>
</li>
<li><p>数据库结构设计和SQL语句。（重点优化）</p>
</li>
</ol>
<h2 id="2-2-MySQL体系结构"><a href="#2-2-MySQL体系结构" class="headerlink" title="2.2 MySQL体系结构"></a>2.2 MySQL体系结构</h2><p>​    分三层：客户端 -&gt; 服务层 -&gt; 存储引擎</p>
<p><img src="/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/MySQL性能管理及架构设计/MySQL体系结构.png" alt="img"></p>
<p>​   </p>
<ol>
<li><code>MySQL</code>是<code>插件式的存储引擎</code>，其中存储引擎分很多种。只要实现符合mysql存储引擎的接口，可以开发自己的存储引擎!</li>
<li>所有跨存储引擎的功能都是在服务层实现的。</li>
<li>MySQL的存储引擎是针对表的，不是针对库的。也就是说在一个数据库中可以使用不同的存储引擎。但是不建议这样做。</li>
</ol>
<h2 id="2-3-InnoDB存储引擎"><a href="#2-3-InnoDB存储引擎" class="headerlink" title="2.3 InnoDB存储引擎"></a>2.3 InnoDB存储引擎</h2><p>​    <code>MySQL5.5</code>及之后版本默认的存储引擎：<code>InnoDB</code>。</p>
<p><img src="/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/MySQL性能管理及架构设计/InnoDB.png" alt="img"></p>
<h3 id="2-3-1-InnoDB使用表空间进行数据存储。"><a href="#2-3-1-InnoDB使用表空间进行数据存储。" class="headerlink" title="2.3.1 InnoDB使用表空间进行数据存储。"></a>2.3.1 InnoDB使用表空间进行数据存储。</h3><p><code>show variables like &#39;innodb_file_per_table</code></p>
<p>  如果innodb_file_per_table 为 ON 将建立独立的表空间，文件为tablename.ibd；</p>
<p>  如果innodb_file_per_table 为 OFF 将数据存储到系统的共享表空间，文件为ibdataX（X为从1开始的整数）；</p>
<p>  <code>.frm</code> ：是服务器层面产生的文件，类似服务器层的数据字典，记录表结构。</p>
<h3 id="2-3-2-MySQL5-5默认-系统表空间与-MySQL5-6及以后默认-独立表空间"><a href="#2-3-2-MySQL5-5默认-系统表空间与-MySQL5-6及以后默认-独立表空间" class="headerlink" title="2.3.2 (MySQL5.5默认)系统表空间与(MySQL5.6及以后默认)独立表空间"></a>2.3.2 (MySQL5.5默认)系统表空间与(<code>MySQL5.6</code>及以后默认)独立表空间</h3><p>​    1.1 系统表空间无法简单的收缩文件大小，造成空间浪费，并会产生大量的磁盘碎片。</p>
<p>​    1.2 独立表空间可以通过<code>optimeze table</code> 收缩系统文件，不需要重启服务器也不会影响对表的正常访问。</p>
<p>​    2.1 如果对多个表进行刷新时，实际上是顺序进行的，会产生IO瓶颈。</p>
<p>​    2.2 独立表空间可以同时向多个文件刷新数据。</p>
<p>强烈建立对Innodb 使用独立表空间，优化什么的更方便，可控。</p>
<h3 id="2-3-3-系统表空间的表转移到独立表空间中的方法"><a href="#2-3-3-系统表空间的表转移到独立表空间中的方法" class="headerlink" title="2.3.3 系统表空间的表转移到独立表空间中的方法"></a>2.3.3 系统表空间的表转移到独立表空间中的方法</h3><p>​    1、使用mysqldump 导出所有数据库数据（存储过程、触发器、计划任务一起都要导出 ）可以在从服务器上操作。</p>
<p>​    2、停止MYsql 服务器，修改参数（my.cnf加入innodb_file_per_table），并删除Inoodb相关文件（可以重建Data目录）。</p>
<p>​    3、重启MYSQL，并重建Innodb系统表空间。</p>
<p>​    4、 重新导入数据。</p>
<p>​    或者 <code>Alter table</code> 同样可以的转移，但是无法回收系统表空间中占用的空间。</p>
<h2 id="2-4-InnoDB存储引擎的特性"><a href="#2-4-InnoDB存储引擎的特性" class="headerlink" title="2.4 InnoDB存储引擎的特性"></a>2.4 InnoDB存储引擎的特性</h2><h3 id="2-4-1-特性一：事务性存储引擎及两个特殊日志类型：Redo-Log-和-Undo-Log"><a href="#2-4-1-特性一：事务性存储引擎及两个特殊日志类型：Redo-Log-和-Undo-Log" class="headerlink" title="2.4.1 特性一：事务性存储引擎及两个特殊日志类型：Redo Log 和 Undo Log"></a>2.4.1 特性一：事务性存储引擎及两个特殊日志类型：Redo Log 和 Undo Log</h3><ol>
<li><code>Innodb</code> 是一种事务性存储引擎。</li>
<li>完全支持事务的<code>ACID</code>特性。</li>
<li>支持事务所需要的两个特殊日志类型：<code>Redo Log</code> 和<code>Undo Log</code></li>
</ol>
<p>​    Redo Log：实现事务的持久性(已提交的事务)。</p>
<p>​    Undo Log：未提交的事务，独立于表空间，需要随机访问，可以存储在高性能io设备上。</p>
<blockquote>
<p><code>Undo</code>日志记录某数据被修改前的值，可以用来在事务失败时进行<code>rollback</code>；<code>Redo</code>日志记录某数据块被修改后的值，可以用来恢复未写入<code>data file</code>的已成功事务更新的数据。</p>
</blockquote>
<h3 id="2-4-2-特性二：支持行级锁"><a href="#2-4-2-特性二：支持行级锁" class="headerlink" title="2.4.2 特性二：支持行级锁"></a>2.4.2 特性二：支持行级锁</h3><ol>
<li>InnoDB支持行级锁。</li>
<li>行级锁可以最大程度地支持并发。</li>
<li>行级锁是由存储引擎层实现的。</li>
</ol>
<h3 id="2-4-3-特性三：Innodb状态检查"><a href="#2-4-3-特性三：Innodb状态检查" class="headerlink" title="2.4.3 特性三：Innodb状态检查"></a>2.4.3 特性三：Innodb状态检查</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">engine</span> <span class="keyword">innodb</span> <span class="keyword">status</span></span><br></pre></td></tr></table></figure>
<h3 id="2-4-4-适用场景"><a href="#2-4-4-适用场景" class="headerlink" title="2.4.4 适用场景"></a>2.4.4 适用场景</h3><ul>
<li>大多数OLTP应用（5.7之后Innodb也支持全文索引和空间函数）</li>
</ul>
<h2 id="2-5-什么是锁"><a href="#2-5-什么是锁" class="headerlink" title="2.5 什么是锁"></a>2.5 什么是锁</h2><h3 id="2-5-1-锁"><a href="#2-5-1-锁" class="headerlink" title="2.5.1 锁"></a>2.5.1 锁</h3><ul>
<li>锁的主要作用是管理共享资源的并发访问</li>
<li>锁用于实现事物的隔离性</li>
</ul>
<h3 id="2-5-2-锁类型"><a href="#2-5-2-锁类型" class="headerlink" title="2.5.2 锁类型"></a>2.5.2 锁类型</h3><ul>
<li><p>共享锁（读锁）</p>
</li>
<li><p>独占锁（写锁）</p>
<p>|      |  写锁  |  读锁  |<br>| :–: | :—-: | :—-: |<br>| 写锁 | 不兼容 | 不兼容 |<br>| 读锁 | 不兼容 |  兼容  |</p>
</li>
</ul>
<h3 id="2-5-3-锁的粒度"><a href="#2-5-3-锁的粒度" class="headerlink" title="2.5.3 锁的粒度"></a>2.5.3 锁的粒度</h3><p>MySQL的事务支持不是绑定在MySQL服务器本身，而是与存储引擎相关</p>
<p>Innodb中锁的粒度：</p>
<ul>
<li>表级锁</li>
<li>行级锁</li>
</ul>
<p>​    将table_name加表级锁命令：<code>lock table table_name write</code>; 写锁会阻塞其它用户对该表的‘读写’操作，直到写锁被释放：<code>unlock tables</code>；</p>
<ol>
<li>锁的开销越大，粒度越小，并发度越高。</li>
<li>表级锁通常是在服务器层实现的。</li>
<li>行级锁是存储引擎层实现的。innodb的锁机制，服务器层是不知道的</li>
</ol>
<h3 id="2-5-4-阻塞和死锁"><a href="#2-5-4-阻塞和死锁" class="headerlink" title="2.5.4 阻塞和死锁"></a>2.5.4 阻塞和死锁</h3><p>​    （1）阻塞是由于资源不足引起的排队等待现象 。<br>    （2）死锁是由于两个对象在拥有一份资源的情况下申请另一份资源，而另一份资源恰好又是这两对象正持有的，导致两对象无法完成操作，且所持资源无法释放。</p>
<h2 id="2-6-CSV存储引擎"><a href="#2-6-CSV存储引擎" class="headerlink" title="2.6 CSV存储引擎"></a>2.6 CSV存储引擎</h2><h3 id="2-6-1-CSV存储引擎文件系统存储特点："><a href="#2-6-1-CSV存储引擎文件系统存储特点：" class="headerlink" title="2.6.1 CSV存储引擎文件系统存储特点："></a>2.6.1 CSV存储引擎文件系统存储特点：</h3><ul>
<li>数据以文本方式存储在文件中</li>
<li>.CSV文件存储表内容</li>
<li>.CSM文件存储表的元数据如表状态和数据量</li>
<li>.frm文件存储表结构信息</li>
</ul>
<h3 id="2-6-2-CSV存储引擎特点："><a href="#2-6-2-CSV存储引擎特点：" class="headerlink" title="2.6.2 CSV存储引擎特点："></a>2.6.2 CSV存储引擎特点：</h3><ul>
<li>以CSV格式进行数据存储</li>
<li>所有列必须都是不能为NULL的</li>
<li>不支持索引（每次都要全表扫描，查询效率低，不适合大表，不适合在线处理）</li>
<li>可以对数据文件直接编辑，保存文本文件内容</li>
</ul>
<h3 id="2-6-3-适合场景"><a href="#2-6-3-适合场景" class="headerlink" title="2.6.3 适合场景"></a>2.6.3 适合场景</h3><p>适合作为数据交换的中间表</p>
<ul>
<li>电子表格 -&gt; CSV文件 -&gt; MySQL数据目录</li>
<li>电子表格 -&gt; CSV文件 -&gt; 其他web程序</li>
</ul>
<h2 id="2-7-Archive存储引擎"><a href="#2-7-Archive存储引擎" class="headerlink" title="2.7 Archive存储引擎"></a>2.7 Archive存储引擎</h2><h3 id="2-7-1-Archive存储引擎文件系统存储特点"><a href="#2-7-1-Archive存储引擎文件系统存储特点" class="headerlink" title="2.7.1 Archive存储引擎文件系统存储特点"></a>2.7.1 Archive存储引擎文件系统存储特点</h3><ul>
<li>以zlib对标数据进行压缩，磁盘I/O更少</li>
<li>数据存储在ARZ为后缀的文件中</li>
</ul>
<h3 id="2-7-2-Archive存储引擎特点："><a href="#2-7-2-Archive存储引擎特点：" class="headerlink" title="2.7.2 Archive存储引擎特点："></a>2.7.2 Archive存储引擎特点：</h3><ul>
<li>只支持insert和select操作</li>
<li>只允许在自增ID列上加索引</li>
</ul>
<h3 id="2-7-3-适合场景"><a href="#2-7-3-适合场景" class="headerlink" title="2.7.3 适合场景"></a>2.7.3 适合场景</h3><p>日志和数据采集类应用</p>
<h2 id="2-8-Memory存储引擎"><a href="#2-8-Memory存储引擎" class="headerlink" title="2.8 Memory存储引擎"></a>2.8 Memory存储引擎</h2><h3 id="2-8-1-Memory存储引擎文件系统存储特点"><a href="#2-8-1-Memory存储引擎文件系统存储特点" class="headerlink" title="2.8.1 Memory存储引擎文件系统存储特点"></a>2.8.1 Memory存储引擎文件系统存储特点</h3><ul>
<li>也称为HEAP存储引擎，数据保存在内存中（表结构保存在磁盘中，重启后数据丢失，表结构不丢失）</li>
</ul>
<h3 id="2-8-2-Memory存储引擎特点："><a href="#2-8-2-Memory存储引擎特点：" class="headerlink" title="2.8.2 Memory存储引擎特点："></a>2.8.2 Memory存储引擎特点：</h3><ul>
<li>支持HASH索引和BTree索引：等值查找选择HASH索引；范围查找选择BTree索引较好</li>
<li>所有字段都为固定长度 （例如指定varchar(10)，存储时自动转换为char(10)）</li>
<li>不支持BLOB和TEXT等大字段</li>
<li>使用表级锁</li>
<li>最大大小由max_heap_table_size参数决定 </li>
</ul>
<h3 id="2-8-3-Memory存储引擎表-VS临时表"><a href="#2-8-3-Memory存储引擎表-VS临时表" class="headerlink" title="2.8.3 Memory存储引擎表 VS临时表"></a>2.8.3 Memory存储引擎表 VS临时表</h3><p>临时表：</p>
<ol>
<li>系统使用临时表<ul>
<li>超过限制使用MyISAM临时表</li>
<li>未超限制使用Memory</li>
</ul>
</li>
<li>create temporary table 建立的临时表</li>
</ol>
<h3 id="2-8-4-适合场景"><a href="#2-8-4-适合场景" class="headerlink" title="2.8.4 适合场景"></a>2.8.4 适合场景</h3><ul>
<li>用于查找或者映射表，例如邮编和地区的对应表</li>
<li>用于保存数据分析中产生的中间表</li>
<li>用于缓存周期性聚合数据的结果表</li>
</ul>
<p>注意：Memory数据易丢失，所以要求数据可再生</p>
<h2 id="2-9-Federated存储引擎"><a href="#2-9-Federated存储引擎" class="headerlink" title="2.9 Federated存储引擎"></a>2.9 Federated存储引擎</h2><h3 id="2-9-1-Federated存储引擎特点"><a href="#2-9-1-Federated存储引擎特点" class="headerlink" title="2.9.1 Federated存储引擎特点"></a>2.9.1 Federated存储引擎特点</h3><ul>
<li>提供了访问远程MySQL服务器上表的方法</li>
<li>本地不存储数据，数据全部放在远程服务器上</li>
<li>本地需要保存表结构和远程服务器的连接信息</li>
</ul>
<h3 id="2-9-2-如何使用Federated存储引擎"><a href="#2-9-2-如何使用Federated存储引擎" class="headerlink" title="2.9.2 如何使用Federated存储引擎"></a>2.9.2 如何使用Federated存储引擎</h3><p>默认禁止，启用需要在启动时增加federator参数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql://user_name[:password]@host_name[:port_num]/db_name/tbl_name</span><br></pre></td></tr></table></figure>
<h3 id="2-9-3适用场景"><a href="#2-9-3适用场景" class="headerlink" title="2.9.3适用场景"></a>2.9.3适用场景</h3><p>偶尔的统计分析及手工查询</p>
<h2 id="2-10-如何选择正确的存储引擎"><a href="#2-10-如何选择正确的存储引擎" class="headerlink" title="2.10 如何选择正确的存储引擎"></a>2.10 如何选择正确的存储引擎</h2><p>​    参考条件：</p>
<ol>
<li>事务</li>
<li>备份(<code>Innobd</code>免费在线备份)</li>
<li>崩溃恢复</li>
<li>存储引擎的特有特性</li>
</ol>
<p>​    总结:<code>Innodb</code>大法好。</p>
<p><code>注意:</code>尽量别使用混合存储引擎，比如回滚会出问题、在线热备问题。</p>
<h2 id="2-11-配置参数"><a href="#2-11-配置参数" class="headerlink" title="2.11 配置参数"></a>2.11 配置参数</h2><h3 id="2-11-1-MySQL获取配置信息路径"><a href="#2-11-1-MySQL获取配置信息路径" class="headerlink" title="2.11.1 MySQL获取配置信息路径"></a>2.11.1 MySQL获取配置信息路径</h3><ul>
<li><p>命令行参数</p>
<p>mysqld_safe –datadir=/data/sql_data</p>
</li>
<li><p>配置文件</p>
<p>mysqld –help –verbose |grep -A 1 ‘Default options’</p>
<p>/etc/my.cnf    /etc/mysql/my.cnf    /home/mysql/my.cnf    ~/.my.cnf</p>
</li>
</ul>
<h3 id="2-11-2-MySQL配置参数的作用域"><a href="#2-11-2-MySQL配置参数的作用域" class="headerlink" title="2.11.2 MySQL配置参数的作用域"></a>2.11.2 MySQL配置参数的作用域</h3><ul>
<li><p>全局参数</p>
<p>set global 参数名=参数值;</p>
<p>set @@global.参数名 :=参数值;</p>
</li>
<li><p>全局参数</p>
<p>set [session]l 参数名=参数值;</p>
<p>set @@session.参数名 :=参数值;</p>
</li>
</ul>
<h3 id="2-11-3-内存配置相关参数"><a href="#2-11-3-内存配置相关参数" class="headerlink" title="2.11.3 内存配置相关参数"></a>2.11.3 内存配置相关参数</h3><blockquote>
<p>确定可以使用的内存上限。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">内存的使用上限不能超过物理内存，否则容易造成内存溢出；（对于32位操作系统，MySQL只能使用3G以下的内存。）</span><br></pre></td></tr></table></figure>
<blockquote>
<p>确定MySQL的每个连接<code>单独</code>使用的内存。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sort_buffer_size #定义了每个线程排序缓存区的大小，MySQL在有查询、需要做排序操作时才会为每个缓冲区分配内存（直接分配该参数的全部内存）；</span><br><span class="line"></span><br><span class="line">join_buffer_size #定义了每个线程所使用的连接缓冲区的大小，如果一个查询关联了多张表，MySQL会为每张表分配一个连接缓冲，导致一个查询产生了多个连接缓冲；</span><br><span class="line"></span><br><span class="line">read_buffer_size #定义了当对一张MyISAM进行全表扫描时所分配读缓冲池大小，MySQL有查询需要时会为其分配内存，其必须是4k的倍数；</span><br><span class="line"></span><br><span class="line">read_rnd_buffer_size #索引缓冲区大小，MySQL有查询需要时会为其分配内存，只会分配需要的大小。</span><br></pre></td></tr></table></figure>
<p>​    注意：以上四个参数是为一个线程分配的，如果有100个连接，那么需要×100。</p>
<p>　①MySQL是<code>单进程多线程</code>（而oracle是多进程），也就是说<code>MySQL</code>实例在系统上表现就是一个服务进程，即进程；</p>
<p>　②MySQL实例是线程和内存组成，实例才是真正用于操作数据库文件的；</p>
<p>一般情况下一个实例操作一个或多个数据库；集群情况下多个实例操作一个或多个数据库。</p>
<blockquote>
<p>确定需要为操作系统保留多少内存</p>
</blockquote>
<blockquote>
<p>如何为缓存池分配内存</p>
</blockquote>
<p>​    <code>Innodb_buffer_pool_size</code>，定义了Innodb所使用缓存池的大小，对其性能十分重要，必须足够大，但是过大时，使得Innodb 关闭时候需要更多时间把脏页从缓冲池中刷新到磁盘中；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">总内存 -（每个线程所需要的内存*连接数）- 系统保留内存</span><br></pre></td></tr></table></figure>
<p>​    <code>key_buffer_size</code>，定义了MyISAM所使用的缓存池的大小，由于数据是依赖存储操作系统缓存的，所以要为操作系统预留更大的内存空间；</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">sum</span>(index_length) <span class="keyword">from</span> information_schema.talbes <span class="keyword">where</span> <span class="keyword">engine</span>=<span class="string">'myisam'</span></span><br></pre></td></tr></table></figure>
<p>​    注意：即使开发使用的表全部是Innodb表，也要为MyISAM预留内存，因为MySQL系统使用的表仍然是MyISAM表。</p>
<p>​    <code>max_connections</code> 控制允许的最大连接数， 一般2000更大。<br>    不要使用外键约束保证数据的完整性。</p>
<h2 id="2-12-性能优化顺序"><a href="#2-12-性能优化顺序" class="headerlink" title="2.12 性能优化顺序"></a>2.12 性能优化顺序</h2><p>从上到下：</p>
<ul>
<li>数据库结构设计和SQL语句</li>
<li>数据库存储引擎的选择和参数配置</li>
<li>系统选择及优化</li>
<li>硬件升级</li>
</ul>

        </div>

        <blockquote class="post-copyright">
    
    <footer>
        <a href="https://bameirilyo.github.io/BameirilyoBlog">
            <img src="/BameirilyoBlog/img/avatar.jpg" alt="豆腐小铭">
            豆腐小铭
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/BameirilyoBlog/tags/数据库/">数据库</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://bameirilyo.github.io/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/&title=《MySQL性能管理及架构设计(一)》 — Bameirilyo's Blog&pic=https://bameirilyo.github.io/BameirilyoBlog/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://bameirilyo.github.io/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/&title=《MySQL性能管理及架构设计(一)》 — Bameirilyo's Blog&source=个人博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
<!--      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://bameirilyo.github.io/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《MySQL性能管理及架构设计(一)》 — Bameirilyo's Blog&url=https://bameirilyo.github.io/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/&via=https://bameirilyo.github.io/BameirilyoBlog" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://bameirilyo.github.io/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>     -->
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/BameirilyoBlog/2018/07/16/MySQL性能管理及架构设计(二)/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> 上一篇</div>
        <h4 class="title">MySQL性能管理及架构设计(二)</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/BameirilyoBlog/2018/05/27/Redis安装过程及报错缺少tcl解决方法/" id="post-next" class="post-nav-link">
        <div class="tips">下一篇 <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Redis安装过程及报错缺少tcl解决方法</h4>
      </a>
    </div>
  
</nav>



    














</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


  
    </div>
    <div class="bottom">
	<!--  config.author  -->
        <p><span>个人专属 &copy; 2016 - 2018</span>
            <span>
                
                Power by —— Bameirilyo
			<!-- <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a> -->
            </span>
        </p>
		<p>
          
                <span><a href=" " target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
           
            <span>博客 —— 豆腐小铭</span>   
        </p> 
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://bameirilyo.github.io/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/&title=《MySQL性能管理及架构设计(一)》 — Bameirilyo's Blog&pic=https://bameirilyo.github.io/BameirilyoBlog/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://bameirilyo.github.io/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/&title=《MySQL性能管理及架构设计(一)》 — Bameirilyo's Blog&source=个人博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
<!--      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://bameirilyo.github.io/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《MySQL性能管理及架构设计(一)》 — Bameirilyo's Blog&url=https://bameirilyo.github.io/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/&via=https://bameirilyo.github.io/BameirilyoBlog" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://bameirilyo.github.io/BameirilyoBlog/2018/07/15/MySQL性能管理及架构设计(一)/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>     -->
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAADLUlEQVR42u3aQW7jMAwF0N7/0h1gVrNo3P9JFxOrT6vAcW09CShDUh8f8fj8O15d/3dcf9s+5/r+63tuGNjY2NgPYX9ejvz1yeSur+TXX80tsWBjY2Ofym6DRB6Qrt81nPTlUkbbg42Njf0r2XnIaUPXDJynJdjY2NjY7RK0haqckSwfNjY29u9kJ0Wl9s59A6Bd+h+ppWFjY2O/Pfsngs3/+vyD/W1sbGzst2R/LkZS9G9LUck826bCF3PAxsbGPojdvn5W7s+XJi8kbQpM2NjY2Cex2/LQvjC0Wej8+jc6bGxs7IPYdz30rsZwXtC/oQmBjY2NfRC7rZznk95/mxewVokWNjY29sPZ9b/7sg3cJjP50sw2ABsbG/tUdl7QaaeSpDotNUlasLGxsX8nu31cG5baZd0Xnoqoi42Njf1Ydv6v/zrNuCsc5htzb0KFjY2N/Vx2HrTyAzF5m6FNJ9o7vzmyg42Njf1w9mZa+yM17WGg9srLZ2JjY2MfxG6n2/6e35eH2rZum2tgY2Njn8Fuy0b7ZvCsSDQLci/niY2NjX0EexZONpNrWxH75sEXn7GxsbEPYuel/9mxmDZRaRsDs+YENjY29kns2fGXJHXJJ9QGvHyGL69gY2NjH8ROxl2t2faQzaypUHRCsLGxsY9g7w/W5ElFDphdL9IqbGxs7EPZm0M5m0nsW8v1sR5sbGzsg9h3/Upv27RtCrEpRUWBFhsbG/vh7FmRPT9Mk49Zsam9ExsbG/s8dpsktI9uG8NtS2CWqGBjY2Ofys5fc1frt12+djO+mTM2Njb2cey8DJT8Vd64Td6ybyF/tABsbGzsx7Lbn/6zA5d5+MzDUrIB2NjY2Key2zFrr7at3NkG3EzFxsbGfmP2rBF7b6qQ78ks8fjiW2xsbOyD2LMwkAPyNkPeTsjn1qZJ2NjY2M9l5wci8wZt2zCYhbRVAMPGxsY+jr0JDJtyUp7ezFIXbGxsbOxZA7U9+rPpY+RNBWxsbGzsWTkpD0554ak9jvOy3YuNjY19EDsp8cyO6bQLlzcb2kOc2NjY2KeyZ43eFpY/Id+MVXsAGxsb+wT2H7VItalbPu0JAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/BameirilyoBlog/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'Bameirilyo's Blog';
            clearTimeout(titleTime);
        } else {
            document.title = 'Bameirilyo's Blog';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
